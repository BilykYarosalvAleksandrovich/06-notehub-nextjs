(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[151],{7499:function(e,t,n){Promise.resolve().then(n.bind(n,5734)),Promise.resolve().then(n.bind(n,2094)),Promise.resolve().then(n.bind(n,4984)),Promise.resolve().then(n.bind(n,9827)),Promise.resolve().then(n.bind(n,4147)),Promise.resolve().then(n.bind(n,2868)),Promise.resolve().then(n.bind(n,7026)),Promise.resolve().then(n.bind(n,1770)),Promise.resolve().then(n.bind(n,6451)),Promise.resolve().then(n.bind(n,8164)),Promise.resolve().then(n.bind(n,1632)),Promise.resolve().then(n.bind(n,3244)),Promise.resolve().then(n.bind(n,7985)),Promise.resolve().then(n.bind(n,7984))},5734:function(e,t,n){"use strict";n.d(t,{default:function(){return q}});var o=n(7437),r=n(2265),s=n(1632),a=n(8584),i=n(1931),l=n(9116),c=n(551),u=n.n(c);function d(e){let{value:t,onChange:n}=e;return(0,o.jsx)("input",{className:u().input,type:"text",placeholder:"Search notes",value:t,onChange:e=>{n(e.target.value)}})}var m=n(5103),h=n.n(m),_=n(729),p=n.n(_);function N(e){let{current:t,totalPages:n,onPageChange:r}=e;return n<=1?null:(0,o.jsx)("nav",{className:p().paginationWrapper,children:(0,o.jsx)(h(),{breakLabel:"...",nextLabel:">",onPageChange:e=>{r(e.selected+1)},pageRangeDisplayed:3,marginPagesDisplayed:1,pageCount:n,forcePage:t-1,previousLabel:"<",renderOnZeroPageCount:null,containerClassName:p().pagination,pageLinkClassName:p().pageLink,activeLinkClassName:p().activeLink,previousLinkClassName:p().prevNextLink,nextLinkClassName:p().prevNextLink,breakLinkClassName:p().breakLink,disabledClassName:p().disabled})})}var v=n(9827),b=n(1770),g=n(4231),x=n.n(g),f=n(7648);function j(e){let{notes:t}=e,n=(0,v.useQueryClient)(),r=(0,b.useMutation)({mutationFn:e=>(0,l.f_)(e),onSuccess:()=>{n.invalidateQueries({queryKey:["notes"]})},onError:e=>{console.error("Error deleting note:",e),alert("Failed to delete note. See console for details.")}}),s=e=>{r.mutate(e)};return t&&0!==t.length?(0,o.jsx)("ul",{className:x().list,children:t.map(e=>(0,o.jsxs)("li",{className:x().listItem,children:[(0,o.jsx)("h2",{className:x().title,children:e.title}),(0,o.jsx)("p",{className:x().content,children:e.content}),(0,o.jsxs)("div",{className:x().footer,children:[(0,o.jsx)("span",{className:x().tag,children:e.tag}),(0,o.jsx)(f.default,{href:"/notes/".concat(e.id),className:x().detailsLink,children:"View details"}),(0,o.jsx)("button",{className:x().button,onClick:()=>s(e.id),disabled:r.isPending,children:"Delete"})]})]},e.id))}):null}var y=n(4887),k=n(3565),P=n.n(k);function C(e){let{onClose:t,children:n}=e,s=(0,r.useRef)(null),a=document.querySelector("#modal-root");return((0,r.useEffect)(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow="auto"}),[]),(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.code&&t()};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[t]),a)?y.createPortal((0,o.jsx)("div",{className:P().backdrop,ref:s,onClick:e=>{e.target===s.current&&t()},children:(0,o.jsx)("div",{className:P().modal,children:n})}),a):(console.error("Target container #modal-root not found in the DOM."),null)}var L=n(7314),w=n(4422),F=n(7127),E=n.n(F);let I=["Todo","Work","Personal","Meeting","Shopping"],S=w.Ry().shape({title:w.Z_().min(3,"Title must be at least 3 characters").max(50,"Title must be at most 50 characters").required("Title is required"),content:w.Z_().max(500,"Content must be at most 500 characters"),tag:w.Z_().oneOf(I,"Invalid tag selected").required("Tag is required")});function T(e){let{onClose:t,onNoteCreated:n}=e,r=(0,v.useQueryClient)(),s=(0,b.useMutation)({mutationFn:e=>(0,l.kT)(e),onSuccess:()=>{r.invalidateQueries({queryKey:["notes"]}),n(),t()},onError:e=>{console.error("Error creating note:",e),alert("Failed to create note. See console for details.")}});return(0,o.jsxs)("div",{children:[(0,o.jsx)("h2",{children:"Create note"}),(0,o.jsx)(L.J9,{initialValues:{title:"",content:"",tag:"Todo"},validationSchema:S,onSubmit:e=>{s.mutate(e)},children:e=>{let{isSubmitting:n}=e;return(0,o.jsxs)(L.l0,{className:E().form,children:[(0,o.jsxs)("div",{className:E().formGroup,children:[(0,o.jsx)("label",{htmlFor:"title",children:"Title"}),(0,o.jsx)(L.gN,{id:"title",name:"title",className:E().input}),(0,o.jsx)(L.Bc,{name:"title",component:"span",className:E().error})]}),(0,o.jsxs)("div",{className:E().formGroup,children:[(0,o.jsx)("label",{htmlFor:"content",children:"Content"}),(0,o.jsx)(L.gN,{id:"content",name:"content",as:"textarea",rows:8,className:E().textarea}),(0,o.jsx)(L.Bc,{name:"content",component:"span",className:E().error})]}),(0,o.jsxs)("div",{className:E().formGroup,children:[(0,o.jsx)("label",{htmlFor:"tag",children:"Tag"}),(0,o.jsx)(L.gN,{id:"tag",name:"tag",as:"select",className:E().select,children:I.map(e=>(0,o.jsx)("option",{value:e,children:e},e))}),(0,o.jsx)(L.Bc,{name:"tag",component:"span",className:E().error})]}),(0,o.jsxs)("div",{className:E().actions,children:[(0,o.jsx)("button",{type:"button",className:E().cancelButton,onClick:t,disabled:s.isPending,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:E().submitButton,disabled:n||s.isPending,children:s.isPending?"Creating...":"Create note"})]}),s.isError&&(0,o.jsx)("p",{className:E().apiError,children:"Error: Failed to create note. Please try again."})]})}})]})}var B=n(4146),O=n.n(B);function q(e){var t;let{dehydratedState:n}=e,[c,u]=(0,r.useState)(""),[m,h]=(0,r.useState)(1),[_,p]=(0,r.useState)(!1),[v]=(0,i.Nr)(c,500),{data:b,isLoading:g,isError:x,isFetching:f}=(0,s.useQuery)({queryKey:["notes",m,v],queryFn:()=>(0,l.jO)({page:m,perPage:8,search:v}),placeholderData:e=>e});return(0,o.jsx)(a.R,{state:n,children:(0,o.jsxs)("div",{className:O().container,children:[(0,o.jsxs)("header",{className:O().toolbar,children:[(0,o.jsx)(d,{value:c,onChange:e=>{u(e),h(1)}}),b&&b.totalPages>1&&(0,o.jsx)(N,{current:m,totalPages:null!==(t=b.totalPages)&&void 0!==t?t:1,onPageChange:e=>h(e)}),(0,o.jsx)("button",{className:O().button,onClick:()=>p(!0),children:"Create note +"})]}),(0,o.jsxs)("main",{children:[g&&!b&&(0,o.jsx)("p",{children:"Loading notes..."}),f&&!g&&(0,o.jsx)("p",{children:"Updating results..."}),x&&(0,o.jsx)("p",{children:"Something went wrong loading notes."}),(null==b?void 0:b.notes)&&b.notes.length>0?(0,o.jsx)(j,{notes:b.notes}):!g&&!x&&(0,o.jsx)("p",{children:"No notes found"})]}),_&&(0,o.jsx)(C,{onClose:()=>p(!1),children:(0,o.jsx)(T,{onClose:()=>p(!1),onNoteCreated:()=>{u(""),h(1),p(!1)}})})]})})}},8584:function(e,t,n){"use strict";n.d(t,{R:function(){return r.HydrationBoundary},default:function(){return l}});var o=n(7437),r=n(2094),s=n(4114),a=n(9827),i=n(2265);function l(e){let{children:t}=e,[n]=(0,i.useState)(()=>new s.S({defaultOptions:{queries:{staleTime:5e3}}}));return(0,o.jsx)(a.QueryClientProvider,{client:n,children:t})}},9116:function(e,t,n){"use strict";n.d(t,{DH:function(){return c},f_:function(){return d},jO:function(){return l},kT:function(){return u}});var o=n(3464),r=n(3577),s=n(257);let a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6ImJpbHlrLnlhcm9zbGF2LmFsZWtzYW5kcm92aWNoQGdtYWlsLmNvbSIsImlhdCI6MTc2NDAxMDg0M30.jOJ1e0HAEUJ2KFZyulQcq0DJJDmPAFZbmQMyuqyG6OQ";if(!a)throw console.error("NEXT_PUBLIC_NOTEHUB_TOKEN is missing. Please check your .env file and restart the server."),Error("NEXT_PUBLIC_NOTEHUB_TOKEN is missing");let i=o.default.create({baseURL:"https://notehub-public.goit.study/api",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"application/json"}}),l=async e=>{try{return(await i.get("/notes",{params:e})).data}catch(e){var t;throw(0,r.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("401 Unauthorized: Failed to fetch notes. Please check token."),e}};async function c(e){let t=await fetch("".concat(s.env.API_URL,"/notes/").concat(e));if(!t.ok)throw Error("Note not found");return t.json()}let u=async e=>{try{return(await i.post("/notes",e)).data}catch(e){var t;throw(0,r.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("401 Unauthorized: Failed to create note. Please check token."),e}},d=async e=>{try{return(await i.delete("/notes/".concat(e))).data}catch(e){var t;throw(0,r.IZ)(e)&&(null===(t=e.response)||void 0===t?void 0:t.status)===401&&console.error("401 Unauthorized: Failed to delete note. Please check token."),e}}},4146:function(e){e.exports={container:"Notes_container__YZugq",toolbar:"Notes_toolbar__vxiBS",button:"Notes_button__E1JoO"}},3565:function(e){e.exports={backdrop:"Modal_backdrop__bLvvH",modal:"Modal_modal__nSuXm"}},7127:function(e){e.exports={form:"NoteForm_form__kBK_0",formGroup:"NoteForm_formGroup__bS5ba",input:"NoteForm_input__28hgd",textarea:"NoteForm_textarea__kzing",select:"NoteForm_select__Go8Rq",actions:"NoteForm_actions__aG_Xr",submitButton:"NoteForm_submitButton__vSvUI",cancelButton:"NoteForm_cancelButton__c33li",error:"NoteForm_error__swtoj"}},4231:function(e){e.exports={list:"NoteList_list__shWPg",listItem:"NoteList_listItem__SuGUK",title:"NoteList_title__yrB3L",content:"NoteList_content__K8ntu",button:"NoteList_button__J1AiO",footer:"NoteList_footer__lWpqj",tag:"NoteList_tag__obj_m"}},729:function(e){e.exports={pagination:"Pagination_pagination__O7JWM",active:"Pagination_active__awQnD"}},551:function(e){e.exports={input:"SearchBox_input__0g6b5"}}},function(e){e.O(0,[153,247,313,12,279,971,117,744],function(){return e(e.s=7499)}),_N_E=e.O()}]);